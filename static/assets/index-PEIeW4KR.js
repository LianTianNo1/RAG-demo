import{j as e,M as ze}from"./utils-D84y-Eax.js";import{c as Oe,g as De,r as m,R as ke}from"./vendor-o6zXO7vr.js";import{T as B,C as ge,R as Le,a as je,b as F,S as $,c as Ae,d as N,e as ae,I as Fe,E as ye,f as E,B as T,g as Ue,h as se,i as Be,A as ce,j as U,U as Ye,k as qe,P as Ke,l as Ve,m as Ge,n as de,L as ee,o as He,p as Je,s as _,q as ue,r as We,t as Qe,u as ve,D as fe,v as Xe,w as Ze,x as me,y as pe,z as et,F as tt}from"./antd-Brh7cmhH.js";(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function l(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(s){if(s.ep)return;s.ep=!0;const r=l(s);fetch(s.href,r)}})();var re={},xe=Oe;re.createRoot=xe.createRoot,re.hydrateRoot=xe.hydrateRoot;var Y={},be={exports:{}};(function(t){function o(l){return l&&l.__esModule?l:{default:l}}t.exports=o,t.exports.__esModule=!0,t.exports.default=t.exports})(be);var q=be.exports,K={};Object.defineProperty(K,"__esModule",{value:!0});K.default=void 0;var st={items_per_page:"条/页",jump_to:"跳至",jump_to_confirm:"确定",page:"页",prev_page:"上一页",next_page:"下一页",prev_5:"向前 5 页",next_5:"向后 5 页",prev_3:"向前 3 页",next_3:"向后 3 页",page_size:"页码"};K.default=st;var V={},z={},G={},Ne={exports:{}},Se={exports:{}},_e={exports:{}},$e={exports:{}};(function(t){function o(l){"@babel/helpers - typeof";return t.exports=o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},t.exports.__esModule=!0,t.exports.default=t.exports,o(l)}t.exports=o,t.exports.__esModule=!0,t.exports.default=t.exports})($e);var we=$e.exports,Pe={exports:{}};(function(t){var o=we.default;function l(n,s){if(o(n)!="object"||!n)return n;var r=n[Symbol.toPrimitive];if(r!==void 0){var i=r.call(n,s||"default");if(o(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(n)}t.exports=l,t.exports.__esModule=!0,t.exports.default=t.exports})(Pe);var rt=Pe.exports;(function(t){var o=we.default,l=rt;function n(s){var r=l(s,"string");return o(r)=="symbol"?r:r+""}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports})(_e);var at=_e.exports;(function(t){var o=at;function l(n,s,r){return(s=o(s))in n?Object.defineProperty(n,s,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[s]=r,n}t.exports=l,t.exports.__esModule=!0,t.exports.default=t.exports})(Se);var ot=Se.exports;(function(t){var o=ot;function l(s,r){var i=Object.keys(s);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(s);r&&(a=a.filter(function(d){return Object.getOwnPropertyDescriptor(s,d).enumerable})),i.push.apply(i,a)}return i}function n(s){for(var r=1;r<arguments.length;r++){var i=arguments[r]!=null?arguments[r]:{};r%2?l(Object(i),!0).forEach(function(a){o(s,a,i[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(i)):l(Object(i)).forEach(function(a){Object.defineProperty(s,a,Object.getOwnPropertyDescriptor(i,a))})}return s}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports})(Ne);var nt=Ne.exports,H={};Object.defineProperty(H,"__esModule",{value:!0});H.commonLocale=void 0;H.commonLocale={yearFormat:"YYYY",dayFormat:"D",cellMeridiemFormat:"A",monthBeforeYear:!0};var lt=q.default;Object.defineProperty(G,"__esModule",{value:!0});G.default=void 0;var he=lt(nt),it=H,ct=(0,he.default)((0,he.default)({},it.commonLocale),{},{locale:"zh_CN",today:"今天",now:"此刻",backToToday:"返回今天",ok:"确定",timeSelect:"选择时间",dateSelect:"选择日期",weekSelect:"选择周",clear:"清除",week:"周",month:"月",year:"年",previousMonth:"上个月 (翻页上键)",nextMonth:"下个月 (翻页下键)",monthSelect:"选择月份",yearSelect:"选择年份",decadeSelect:"选择年代",previousYear:"上一年 (Control键加左方向键)",nextYear:"下一年 (Control键加右方向键)",previousDecade:"上一年代",nextDecade:"下一年代",previousCentury:"上一世纪",nextCentury:"下一世纪",yearFormat:"YYYY年",cellDateFormat:"D",monthBeforeYear:!1});G.default=ct;var O={};Object.defineProperty(O,"__esModule",{value:!0});O.default=void 0;const dt={placeholder:"请选择时间",rangePlaceholder:["开始时间","结束时间"]};O.default=dt;var Ie=q.default;Object.defineProperty(z,"__esModule",{value:!0});z.default=void 0;var ut=Ie(G),ft=Ie(O);const Re={lang:Object.assign({placeholder:"请选择日期",yearPlaceholder:"请选择年份",quarterPlaceholder:"请选择季度",monthPlaceholder:"请选择月份",weekPlaceholder:"请选择周",rangePlaceholder:["开始日期","结束日期"],rangeYearPlaceholder:["开始年份","结束年份"],rangeMonthPlaceholder:["开始月份","结束月份"],rangeQuarterPlaceholder:["开始季度","结束季度"],rangeWeekPlaceholder:["开始周","结束周"]},ut.default),timePickerLocale:Object.assign({},ft.default)};Re.lang.ok="确定";z.default=Re;var mt=q.default;Object.defineProperty(V,"__esModule",{value:!0});V.default=void 0;var pt=mt(z);V.default=pt.default;var J=q.default;Object.defineProperty(Y,"__esModule",{value:!0});Y.default=void 0;var xt=J(K),ht=J(V),gt=J(z),jt=J(O);const g="${label}不是一个有效的${type}",yt={locale:"zh-cn",Pagination:xt.default,DatePicker:gt.default,TimePicker:jt.default,Calendar:ht.default,global:{placeholder:"请选择",close:"关闭"},Table:{filterTitle:"筛选",filterConfirm:"确定",filterReset:"重置",filterEmptyText:"无筛选项",filterCheckAll:"全选",filterSearchPlaceholder:"在筛选项中搜索",emptyText:"暂无数据",selectAll:"全选当页",selectInvert:"反选当页",selectNone:"清空所有",selectionAll:"全选所有",sortTitle:"排序",expand:"展开行",collapse:"关闭行",triggerDesc:"点击降序",triggerAsc:"点击升序",cancelSort:"取消排序"},Modal:{okText:"确定",cancelText:"取消",justOkText:"知道了"},Tour:{Next:"下一步",Previous:"上一步",Finish:"结束导览"},Popconfirm:{cancelText:"取消",okText:"确定"},Transfer:{titles:["",""],searchPlaceholder:"请输入搜索内容",itemUnit:"项",itemsUnit:"项",remove:"删除",selectCurrent:"全选当页",removeCurrent:"删除当页",selectAll:"全选所有",deselectAll:"取消全选",removeAll:"删除全部",selectInvert:"反选当页"},Upload:{uploading:"文件上传中",removeFile:"删除文件",uploadError:"上传错误",previewFile:"预览文件",downloadFile:"下载文件"},Empty:{description:"暂无数据"},Icon:{icon:"图标"},Text:{edit:"编辑",copy:"复制",copied:"复制成功",expand:"展开",collapse:"收起"},Form:{optional:"（可选）",defaultValidateMessages:{default:"字段验证错误${label}",required:"请输入${label}",enum:"${label}必须是其中一个[${enum}]",whitespace:"${label}不能为空字符",date:{format:"${label}日期格式无效",parse:"${label}不能转换为日期",invalid:"${label}是一个无效日期"},types:{string:g,method:g,array:g,object:g,number:g,date:g,boolean:g,integer:g,float:g,regexp:g,email:g,url:g,hex:g},string:{len:"${label}须为${len}个字符",min:"${label}最少${min}个字符",max:"${label}最多${max}个字符",range:"${label}须在${min}-${max}字符之间"},number:{len:"${label}必须等于${len}",min:"${label}最小值为${min}",max:"${label}最大值为${max}",range:"${label}须在${min}-${max}之间"},array:{len:"须为${len}个${label}",min:"最少${min}个${label}",max:"最多${max}个${label}",range:"${label}数量须在${min}-${max}之间"},pattern:{mismatch:"${label}与模式不匹配${pattern}"}}},Image:{preview:"预览"},QRCode:{expired:"二维码过期",refresh:"点击刷新",scanned:"已扫描"},ColorPicker:{presetEmpty:"暂无",transparent:"无色",singleColor:"单色",gradientColor:"渐变色"}};Y.default=yt;var vt=Y;const bt=De(vt),{Text:I}=B,{Panel:Dt}=ge;function Nt({messages:t,streamingMessage:o}){const l=a=>new Date(a).toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit",second:"2-digit"}),n=a=>!a||a.length===0?null:e.jsx("div",{className:"tool-calls-section",children:e.jsx(ge,{size:"small",ghost:!0,items:a.map((d,u)=>{var y,v,S;let h={};try{h=JSON.parse(((y=d.function)==null?void 0:y.arguments)||"{}")}catch{h={raw:((v=d.function)==null?void 0:v.arguments)||""}}return{key:u,label:e.jsxs($,{children:[e.jsx(Ae,{}),e.jsx(I,{strong:!0,children:((S=d.function)==null?void 0:S.name)||"unknown"}),e.jsx(N,{color:"blue",size:"small",children:"工具调用"})]}),children:e.jsx("div",{className:"tool-call-content",children:e.jsx(I,{code:!0,className:"tool-args",children:JSON.stringify(h,null,2)})})}})})}),s=a=>!a||a.length===0?null:e.jsxs("div",{className:"sources-section",children:[e.jsxs("div",{className:"sources-header",children:[e.jsx(ae,{}),e.jsx(I,{strong:!0,children:"信息来源"})]}),e.jsx("div",{className:"sources-list",children:a.map((d,u)=>e.jsxs("div",{className:"source-item",children:[e.jsx(N,{color:"green",size:"small",children:d.file}),e.jsxs(I,{type:"secondary",children:["工作表: ",d.sheet]})]},u))})]}),r=a=>{const d=a.role==="user",u=a.role==="system",h=a.isStreaming;return e.jsxs("div",{className:`message-item ${d?"user":u?"system":"assistant"} ${h?"streaming":""}`,children:[e.jsx("div",{className:"message-avatar",children:d?e.jsx(Le,{}):u?e.jsx(je,{}):e.jsx(F,{})}),e.jsxs("div",{className:"message-content",children:[e.jsxs("div",{className:"message-header",children:[e.jsx(I,{strong:!0,className:"message-role",children:d?"用户":u?"系统":"AI助手"}),e.jsx(I,{type:"secondary",className:"message-time",children:l(a.timestamp)})]}),e.jsxs("div",{className:"message-body",children:[u?e.jsx(I,{className:"system-message",children:a.content}):e.jsx("div",{className:`message-text ${h?"typing-cursor":""}`,children:e.jsx(ze,{children:a.content})}),n(a.toolCalls),s(a.sources)]})]})]},a.id)},i=[...t];return o&&i.push(o),e.jsx("div",{className:"message-list",children:i.map(r)})}const{TextArea:St}=Fe;function _t({systemOnline:t,vectorStoreReady:o}){const[l,n]=m.useState([{id:"welcome",role:"assistant",content:`👋 欢迎使用RAG Excel智能问答系统！

请先上传Excel文件到左侧的文件管理器，然后就可以开始提问了。

💡 **使用提示：**
- 支持询问Excel中的具体数据
- 可以进行数据分析和统计
- 支持多文件联合查询
- 实时显示工具调用过程`,timestamp:new Date().toISOString(),toolCalls:[],sources:[]}]),[s,r]=m.useState(""),[i,a]=m.useState(!1),[d,u]=m.useState(null),h=m.useRef(null),y=m.useRef(null),v=()=>{var f;(f=h.current)==null||f.scrollIntoView({behavior:"smooth"})};m.useEffect(()=>{v()},[l,d]);const S=()=>`msg_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,j=f=>{n(x=>[...x,{...f,id:S()}])},D=(f,x=[],b=[])=>{u({id:"streaming",role:"assistant",content:f,timestamp:new Date().toISOString(),toolCalls:x,sources:b,isStreaming:!0})},k=()=>{d&&(j({...d,isStreaming:!1}),u(null))},c=async()=>{const f=s.trim();if(!(!f||i)){if(!t){j({role:"system",content:"❌ 系统离线，请检查服务器连接状态",timestamp:new Date().toISOString(),toolCalls:[],sources:[]});return}if(!o){j({role:"system",content:"⚠️ 向量数据库未就绪，请先上传Excel文件",timestamp:new Date().toISOString(),toolCalls:[],sources:[]});return}j({role:"user",content:f,timestamp:new Date().toISOString(),toolCalls:[],sources:[]}),r(""),a(!0);try{const x=await fetch("/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:"rag-excel",messages:[{role:"user",content:f}],temperature:.7,stream:!0})});if(!x.ok)throw new Error(`HTTP ${x.status}: ${x.statusText}`);const b=x.body.getReader(),Ce=new TextDecoder;let W="",Q="",R=[],oe=[];for(;;){const{done:Me,value:Ee}=await b.read();if(Me)break;W+=Ce.decode(Ee,{stream:!0});const ne=W.split(`
`);W=ne.pop();for(const X of ne)if(X.trim()!==""&&X.startsWith("data: ")){const Z=X.slice(6);if(Z.trim()==="[DONE]"){k();break}try{const C=JSON.parse(Z);if(C.choices&&C.choices[0]){const le=C.choices[0],L=le.delta||{};if(L.content&&(Q+=L.content,D(Q,R,oe)),L.tool_calls){for(const M of L.tool_calls)if(M.function&&M.function.name){const ie=R.findIndex(Te=>Te.id===M.id);ie>=0?R[ie]=M:R.push(M),D(Q,[...R],oe)}}if(le.finish_reason==="stop"){k();break}}}catch(C){console.warn("解析SSE数据失败:",C,Z)}}}}catch(x){console.error("发送消息失败:",x),j({role:"system",content:`❌ 发送失败: ${x.message}`,timestamp:new Date().toISOString(),toolCalls:[],sources:[]}),u(null)}finally{a(!1)}}},p=()=>{n([{id:"welcome",role:"assistant",content:"对话已清空，可以开始新的提问。",timestamp:new Date().toISOString(),toolCalls:[],sources:[]}]),u(null)},w=f=>{f.key==="Enter"&&!f.shiftKey&&(f.preventDefault(),c())},P=()=>t?o?null:e.jsx(ce,{message:"向量数据库未就绪",description:"请先上传Excel文件到左侧文件管理器",type:"warning",icon:e.jsx(U,{}),showIcon:!0,className:"system-alert"}):e.jsx(ce,{message:"系统离线",description:"无法连接到后端服务，请检查服务器状态",type:"error",icon:e.jsx(U,{}),showIcon:!0,className:"system-alert"});return e.jsxs("div",{className:"chat-panel",children:[P(),e.jsxs("div",{className:"messages-container",children:[l.length===0?e.jsx(ye,{image:e.jsx(F,{style:{fontSize:64,color:"#d9d9d9"}}),description:"暂无对话消息"}):e.jsx(Nt,{messages:l,streamingMessage:d}),e.jsx("div",{ref:h})]}),e.jsx("div",{className:"input-container",children:e.jsxs("div",{className:"input-wrapper",children:[e.jsx(St,{ref:y,value:s,onChange:f=>r(f.target.value),onKeyPress:w,placeholder:t?o?"输入您的问题... (Shift+Enter换行，Enter发送)":"请先上传Excel文件...":"系统离线，无法发送消息...",disabled:!t||!o||i,autoSize:{minRows:1,maxRows:4},className:"message-input"}),e.jsxs($,{className:"input-actions",children:[e.jsx(E,{title:"清空对话",children:e.jsx(T,{icon:e.jsx(Ue,{}),onClick:p,disabled:i||l.length<=1,type:"text"})}),e.jsx(T,{type:"primary",icon:i?e.jsx(se,{size:"small"}):e.jsx(Be,{}),onClick:c,disabled:!s.trim()||!t||!o||i,loading:i,children:"发送"})]})]})})]})}const{Dragger:$t}=Ye,{Text:A}=B;function wt({onFileChange:t,fileCount:o}){const[l,n]=m.useState([]),[s,r]=m.useState(!1),[i,a]=m.useState(!1),[d,u]=m.useState(0),h=m.useRef(null),y=async()=>{r(!0);try{const c=await fetch("/v1/files/list");if(c.ok){const p=await c.json();n(p.files||[])}else _.error("获取文件列表失败")}catch(c){console.error("加载文件列表失败:",c),_.error("网络错误，无法获取文件列表")}finally{r(!1)}};m.useEffect(()=>{y()},[o]);const v=c=>{if(c===0)return"0 Bytes";const p=1024,w=["Bytes","KB","MB","GB"],P=Math.floor(Math.log(c)/Math.log(p));return parseFloat((c/Math.pow(p,P)).toFixed(2))+" "+w[P]},S=c=>new Date(c).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),j=async c=>{if(!(c.type==="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"||c.type==="application/vnd.ms-excel"||c.name.endsWith(".xlsx")||c.name.endsWith(".xls")))return _.error("只支持Excel文件格式 (.xlsx, .xls)"),!1;const w=10*1024*1024;if(c.size>w)return _.error("文件大小不能超过10MB"),!1;a(!0),u(0);const P=new FormData;P.append("file",c);try{const f=setInterval(()=>{u(b=>b>=90?(clearInterval(f),b):b+Math.random()*20)},200),x=await fetch("/v1/files/upload",{method:"POST",body:P});if(clearInterval(f),u(100),x.ok){const b=await x.json();_.success(b.message||"文件上传成功"),setTimeout(()=>{y(),t==null||t()},1e3)}else{const b=await x.json();_.error(b.detail||"上传失败")}}catch(f){console.error("上传文件失败:",f),_.error("网络错误，上传失败")}finally{a(!1),u(0)}return!1},D=async c=>{try{const p=await fetch(`/v1/files/${encodeURIComponent(c)}`,{method:"DELETE"});if(p.ok){const w=await p.json();_.success(w.message||"文件删除成功"),y(),t==null||t()}else{const w=await p.json();_.error(w.detail||"删除失败")}}catch(p){console.error("删除文件失败:",p),_.error("网络错误，删除失败")}},k={name:"file",multiple:!0,accept:".xlsx,.xls",beforeUpload:j,showUploadList:!1,disabled:i};return e.jsxs("div",{className:"file-manager",children:[e.jsxs("div",{className:"upload-section",children:[e.jsxs($t,{...k,className:"upload-dragger",children:[e.jsx("p",{className:"ant-upload-drag-icon",children:i?e.jsx(se,{size:"large"}):e.jsx(qe,{})}),e.jsx("p",{className:"ant-upload-text",children:i?"正在上传...":"点击或拖拽文件到此区域上传"}),e.jsx("p",{className:"ant-upload-hint",children:"支持 .xlsx 和 .xls 格式，单个文件不超过10MB"})]}),i&&e.jsx("div",{className:"upload-progress",children:e.jsx(Ke,{percent:Math.round(d),size:"small",status:"active"})})]}),e.jsxs("div",{className:"files-section",children:[e.jsxs("div",{className:"files-header",children:[e.jsxs($,{children:[e.jsx(A,{strong:!0,children:"知识库文件"}),e.jsxs(N,{color:"blue",children:[l.length," 个文件"]})]}),e.jsx(T,{icon:e.jsx(Ve,{}),size:"small",onClick:y,loading:s,type:"text"})]}),e.jsx("div",{className:"files-list",children:s?e.jsx("div",{className:"loading-container",children:e.jsx(se,{tip:"加载中..."})}):l.length===0?e.jsx(ye,{image:e.jsx(de,{style:{fontSize:48,color:"#d9d9d9"}}),description:"暂无Excel文件",imageStyle:{height:60},children:e.jsx(T,{type:"primary",icon:e.jsx(Ge,{}),onClick:()=>{var c;return(c=h.current)==null?void 0:c.click()},children:"上传文件"})}):e.jsx(ee,{dataSource:l,renderItem:c=>e.jsx(ee.Item,{className:"file-item",actions:[e.jsx(He,{title:"确定要删除这个文件吗？",description:"删除后将从知识库中移除，无法恢复",onConfirm:()=>D(c.filename),okText:"确定",cancelText:"取消",children:e.jsx(T,{icon:e.jsx(Je,{}),size:"small",type:"text",danger:!0})},"delete")],children:e.jsx(ee.Item.Meta,{avatar:e.jsx(de,{className:"file-icon"}),title:e.jsx(A,{className:"file-name",title:c.filename,children:c.filename}),description:e.jsxs($,{direction:"vertical",size:2,children:[e.jsx(A,{type:"secondary",className:"file-size",children:v(c.size)}),e.jsx(A,{type:"secondary",className:"file-date",children:S(c.modified_time)})]})})})})})]}),e.jsx("input",{ref:h,type:"file",accept:".xlsx,.xls",multiple:!0,style:{display:"none"},onChange:c=>{Array.from(c.target.files).forEach(j),c.target.value=""}})]})}const{Text:kt}=B;function Pt({status:t}){const{online:o,vectorStoreReady:l,fileCount:n,lastUpdate:s}=t,r=d=>{if(!d)return"未知";const u=new Date(d),y=new Date-u,v=Math.floor(y/(1e3*60)),S=Math.floor(v/60),j=Math.floor(S/24);return v<1?"刚刚":v<60?`${v}分钟前`:S<24?`${S}小时前`:j<7?`${j}天前`:u.toLocaleDateString("zh-CN")},i=()=>o?l?e.jsx(N,{icon:e.jsx(We,{}),color:"success",className:"status-tag",children:"正常"}):e.jsx(N,{icon:e.jsx(U,{}),color:"warning",className:"status-tag",children:"未就绪"}):e.jsx(N,{icon:e.jsx(ue,{}),color:"error",className:"status-tag",children:"离线"}),a=()=>o?l?e.jsx(N,{icon:e.jsx(Qe,{}),color:"success",size:"small",children:"就绪"}):e.jsx(N,{icon:e.jsx(U,{}),color:"warning",size:"small",children:"未就绪"}):e.jsx(N,{icon:e.jsx(ue,{}),color:"default",size:"small",children:"离线"});return e.jsx("div",{className:"system-status",children:e.jsxs($,{size:"middle",className:"status-items",children:[e.jsx(E,{title:e.jsxs("div",{children:[e.jsxs("div",{children:["系统状态: ",o?"在线":"离线"]}),e.jsxs("div",{children:["向量库: ",l?"就绪":"未就绪"]}),s&&e.jsxs("div",{children:["最后更新: ",r(s)]})]}),placement:"bottomRight",children:e.jsx("div",{className:"status-item",children:i()})}),e.jsx(E,{title:`向量数据库${l?"已就绪，可以进行问答":"未就绪，请先上传Excel文件"}`,placement:"bottom",children:e.jsx("div",{className:"status-item",children:a()})}),e.jsx(E,{title:`知识库中共有 ${n} 个Excel文件`,placement:"bottom",children:e.jsx("div",{className:"status-item",children:e.jsxs(N,{icon:e.jsx(ae,{}),color:"blue",size:"small",children:[n," 文件"]})})}),s&&e.jsx(E,{title:`向量库最后更新时间: ${new Date(s).toLocaleString("zh-CN")}`,placement:"bottomLeft",children:e.jsx("div",{className:"status-item",children:e.jsx(N,{icon:e.jsx(je,{}),color:"default",size:"small",children:r(s)})})})]})})}const{Header:It,Content:Rt,Footer:Ct}=ve,{Title:Mt,Text:te}=B;function Et(){const[t,o]=m.useState({online:!1,vectorStoreReady:!1,fileCount:0,lastUpdate:null}),[l,n]=m.useState(0),s=()=>{n(r=>r+1)};return m.useEffect(()=>{const r=async()=>{try{const a=await fetch("/health");if(a.ok){const d=await a.json();o({online:!0,vectorStoreReady:d.vector_store_ready,fileCount:d.knowledge_base_files,lastUpdate:d.last_update})}else o(d=>({...d,online:!1}))}catch(a){console.error("系统状态检查失败:",a),o(d=>({...d,online:!1}))}};r();const i=setInterval(r,3e4);return()=>clearInterval(i)},[l]),e.jsxs(ve,{className:"app-layout",children:[e.jsx(It,{className:"app-header",children:e.jsxs("div",{className:"header-content",children:[e.jsxs($,{align:"center",size:"large",children:[e.jsxs("div",{className:"logo",children:[e.jsx(F,{className:"logo-icon"}),e.jsx(Mt,{level:3,className:"logo-text",children:"RAG Excel API"})]}),e.jsx(fe,{type:"vertical",className:"header-divider"}),e.jsx(te,{className:"subtitle",children:"智能Excel问答系统"})]}),e.jsxs($,{align:"center",children:[e.jsx(Pt,{status:t}),e.jsxs("a",{href:"http://localhost:8000/docs",target:"_blank",rel:"noopener noreferrer",className:"header-link",children:[e.jsx(Xe,{})," API文档"]})]})]})}),e.jsx(Rt,{className:"app-content",children:e.jsx("div",{className:"content-container",children:e.jsxs(Ze,{gutter:[24,24],className:"main-row",children:[e.jsx(me,{xs:24,lg:8,xl:6,children:e.jsx(pe,{title:e.jsxs($,{children:[e.jsx(ae,{}),"文件管理"]}),className:"file-manager-card",bodyStyle:{padding:"16px"},children:e.jsx(wt,{onFileChange:s,fileCount:t.fileCount})})}),e.jsx(me,{xs:24,lg:16,xl:18,children:e.jsx(pe,{title:e.jsxs($,{children:[e.jsx(F,{}),"智能问答"]}),className:"chat-panel-card",bodyStyle:{padding:0},children:e.jsx(_t,{systemOnline:t.online,vectorStoreReady:t.vectorStoreReady})})})]})})}),e.jsx(Ct,{className:"app-footer",children:e.jsx("div",{className:"footer-content",children:e.jsxs($,{split:e.jsx(fe,{type:"vertical"}),children:[e.jsx(te,{type:"secondary",children:"© 2024 RAG Excel API - 基于检索增强生成的智能问答系统"}),e.jsxs("a",{href:"https://github.com",target:"_blank",rel:"noopener noreferrer",className:"footer-link",children:[e.jsx(et,{})," GitHub"]}),e.jsx(te,{type:"secondary",children:"Powered by FastAPI + React + Ollama"})]})})})]})}re.createRoot(document.getElementById("root")).render(e.jsx(ke.StrictMode,{children:e.jsx(tt,{locale:bt,theme:{token:{colorPrimary:"#1890ff",borderRadius:8}},children:e.jsx(Et,{})})}));
